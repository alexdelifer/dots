# Variables

force-xinerama yes

set $WALLPAPER ~/Dank/Pictures/Walls/Verge/The_Verge_Hysteresis_Wallpaper_Landscape.0.png


set $KAS 	exec_always --no-startup-id pkill -9
set $ENID 	exec --no-startup-id

set $mod 	Mod1

set $left 	h
set $down 	j
set $up 	k
set $right 	l

set $WS1 "1:TERM"
set $WS2 "2:WEB"
set $WS3 "3:TEXT"
set $WS4 "4:MAIL"
set $WS5 "5:RDP"
set $WS6 "6:ETC"
set $WS7 "7:GAME"
set $WS8 "8:MUSIC"
set $WS9 "9:PASS"
set $WS10 "0:DAEMON"

# Always set wallpaper :)
exec_always --no-startup-id hsetroot -full $WALLPAPER

# OneShot
$ENID xsetroot -cursor_name left_ptr
$ENID setxkbmap -option ctrl:nocaps

# Screen and Auto Lock
$ENID xset s 60 30
$ENID xset dpms 120


# Gnome Sweet Gnome
$ENID /usr/bin/gnome-keyring-daemon --start --components=secrets
$ENID /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1

# POLYBAR
$KAS polybar; ~/.config/polybar/launch.sh &

#$KAS redshift; redshift &
#$KAS picom; sleep 1; picom &
$KAS dunst; dunst &
$KAS flashfocus; flashfocus &
$KAS libinput-gestures; libinput-gestures-setup start &
$KAS devmon; devmon &
#$KAS deadd-notification-center; deadd-notification-center &

# LOCK
$KAS xss-lock;  xss-lock -n ~/.config/i3/dim-screen.sh -- ~/.config/i3/i3lock-fancy-multimonitor &

$ENID unclutter
$ENID mpris-proxy

# Applets
$KAS nm-applet; nm-applet &
$KAS pasystray; pasystray &

# Autorandr


# XOB
exec --no-startup-id mkfifo $I3SOCK.xob && tail -f $I3SOCK.xob | xob

# Aesthetics
font pango:CaskaydiaCove Nerd Font Mono 10
#smart_gaps on
gaps inner 24
gaps outer 6
new_window pixel 4
new_float pixel 4

# class                 border  backgr. text    indicator child_border
client.focused          #c2c3c7 #5f676a #ffffff #ff77a8   #29adff
client.focused_inactive #333333 #5f676a #ffffff #484e50   #5f676a
client.unfocused        #333333 #222222 #888888 #292d2e   #222222
client.urgent           #2f343a #900000 #ffffff #900000   #900000
client.placeholder      #000000 #0c0c0c #ffffff #000000   #0c0c0c
client.background       #ffffff

# Keybinds


bindsym Print --release exec "scrot -s /tmp/screenshot-$(date +%F_%T).png -e 'xclip -selection c -t image/png < $f'"
bindsym Shift+Print exec "scrot /tmp/screenshot-$(date +%F_%T).png -e 'xclip -selection c -t image/png < $f'"


# crutch aka floating mode 
floating_modifier 		$mod
bindsym $mod+Shift+space 	floating toggle
bindsym $mod+space 		focus mode_toggle

# Terminal
bindsym $mod+Return 		exec --no-startup-id alacritty
bindsym $mod+Shift+Return 	exec --no-startup-id alacritty -t floaterm

bindsym $mod+Shift+x 	kill
bindsym $mod+Shift+q 	kill
bindsym $mod+n 		exec --no-startup-id networkmanager_dmenu

# Open
bindsym $mod+Shift+z 	exec --no-startup-id ~/bin/phonesend.sh share-url "$(xclip -o)"
bindsym $mod+z 		exec --no-startup-id ~/bin/open "$(xclip -o)"

# Apps
bindsym $mod+d 		exec --no-startup-id rofi -show drun
bindsym $mod+Tab 	exec --no-startup-id rofi -show window
bindsym $mod+q 		exec --no-startup-id loginctl lock-session

# XF86
#bindsym XF86MonBrightnessUp 	exec --no-startup-id light -A 5
#bindsym XF86MonBrightnessDown 	exec --no-startup-id light -U 5
#bindsym XF86AudioRaiseVolume 	exec --no-startup-id amixer -D pulse sset Master 5%+ && \
#				amixer -D pulse sset Master unmute
#bindsym XF86AudioLowerVolume 	exec --no-startup-id amixer -D pulse sset Master 5%- && \
#				amixer -D pulse sset Master unmute
#bindsym XF86AudioMute 		exec --no-startup-id amixer -D pulse sset Master toggle
#bindsym XF86AudioMicMute 	exec --no-startup-id amixer sset Capture,0 toggle
#bindsym XF86AudioPlay 		exec --no-startup-id playerctl play-pause
#bindsym XF86AudioNext 		exec --no-startup-id playerctl next
#bindsym XF86AudioPrev 		exec --no-startup-id playerctl previous


#bindsym XF86AudioRaiseVolume exec amixer -q set Master 2%+ unmute && amixer sget Master | grep 'Right:' | awk -F'[][]' '{ print substr($2, 0, length($2)-1) }' > $I3SOCK.xob
#
#bindsym XF86AudioLowerVolume exec amixer -q set Master 2%- unmute \
#	&& amixer sget Master \
#	| grep 'Right:' \
#	| awk -F'[][]' '{ print substr($2, 0, length($2)-1) }' \
#	> $I3SOCK.xob
#
#bindsym XF86AudioMute exec (amixer get Master \
#	| grep off > /dev/null \
#	&& amixer -q set Master unmute \
#	&& amixer sget Master \
#	| grep 'Right:' \
#	| awk -F'[][]' '{ print substr($2, 0, length($2)-1) }' \
#	> $I3SOCK.xob) \
#	|| (amixer -q set Master mute && echo 0 \
#	> $I3SOCK.xob)

bindsym XF86AudioRaiseVolume exec --no-startup-id pamixer --allow-boost -ui 2 && pamixer --get-volume > $I3SOCK.xob
bindsym XF86AudioLowerVolume exec --no-startup-id pamixer --allow-boost -ud 2 && pamixer --get-volume > $I3SOCK.xob
bindsym XF86AudioMute exec --no-startup-id pamixer --toggle-mute && ( pamixer --get-mute && echo 0 > $I3SOCK.xob ) || pamixer --get-volume > $SWAYSOCK.wob



bindsym XF86MonBrightnessUp exec --no-startup-id light -A 5 \
	&& light -G \
	| cut -d'.' -f1 \
	> $I3SOCK.xob

bindsym XF86MonBrightnessDown exec --no-startup-id light -U 5 \
	&& light -G \
	| cut -d'.' -f1 \
	> $I3SOCK.xob


bindsym XF86AudioMicMute 	exec --no-startup-id "amixer sset Capture,0 toggle"
bindsym XF86AudioPlay 		exec --no-startup-id playerctl play-pause
bindsym XF86AudioNext 		exec --no-startup-id playerctl next
bindsym XF86AudioPrev 		exec --no-startup-id playerctl previous

bindsym XF86Display exec --no-startup-id autorandr --change; restart

bindsym $mod+$left 	focus left
bindsym $mod+$down 	focus down
bindsym $mod+$up 	focus up
bindsym $mod+$right 	focus right

bindsym $mod+Shift+$left 	move left 150
bindsym $mod+Shift+$down 	move down 150
bindsym $mod+Shift+$up 		move up 150
bindsym $mod+Shift+$right 	move right 150

bindsym Mod4+$left 	resize shrink width 10 px or 10 ppt
bindsym Mod4+$down 	resize grow height 10 px or 10 ppt
bindsym Mod4+$up 	resize shrink height 10 px or 10 ppt
bindsym Mod4+$right 	resize grow width 10 px or 10 ppt

bindsym $mod+v 		split v
bindcode $mod+20 	split v

bindsym $mod+u 		split h
bindcode $mod+Shift+51 	split h
bindcode $mod+51 	split h

bindsym $mod+Shift+f 	sticky toggle
bindsym $mod+f 		fullscreen toggle

bindsym $mod+s 		layout stacking
bindsym $mod+w 		layout tabbed
bindsym $mod+e 		layout toggle split

bindsym $mod+a 		focus parent

bindsym $mod+bracketleft 	workspace prev
bindsym $mod+bracketright 	workspace next

# Multi Monitor Workspace Bliss
bindsym $mod+1 exec --no-startup-id ~/.config/i3/switch-workspace.py $WS1
bindsym $mod+2 exec --no-startup-id ~/.config/i3/switch-workspace.py $WS2
bindsym $mod+3 exec --no-startup-id ~/.config/i3/switch-workspace.py $WS3
bindsym $mod+4 exec --no-startup-id ~/.config/i3/switch-workspace.py $WS4
bindsym $mod+5 exec --no-startup-id ~/.config/i3/switch-workspace.py $WS5
bindsym $mod+6 exec --no-startup-id ~/.config/i3/switch-workspace.py $WS6
bindsym $mod+7 exec --no-startup-id ~/.config/i3/switch-workspace.py $WS7
bindsym $mod+8 exec --no-startup-id ~/.config/i3/switch-workspace.py $WS8
bindsym $mod+9 exec --no-startup-id ~/.config/i3/switch-workspace.py $WS9
bindsym $mod+0 exec --no-startup-id ~/.config/i3/switch-workspace.py $WS10

bindsym $mod+Shift+1 move container to workspace $WS1
bindsym $mod+Shift+2 move container to workspace $WS2
bindsym $mod+Shift+3 move container to workspace $WS3
bindsym $mod+Shift+4 move container to workspace $WS4
bindsym $mod+Shift+5 move container to workspace $WS5
bindsym $mod+Shift+6 move container to workspace $WS6
bindsym $mod+Shift+7 move container to workspace $WS7
bindsym $mod+Shift+8 move container to workspace $WS8
bindsym $mod+Shift+9 move container to workspace $WS9
bindsym $mod+Shift+0 move container to workspace $WS10

bindsym $mod+period move scratchpad                                                           
bindsym $mod+comma scratchpad show

bindsym $mod+Shift+c reload
#bindsym $mod+Shift+r restart
#bindsym $mod+Shift+r restart
#bindsym $mod+Shift+r exec autorandr --change; restart
bindsym $mod+Shift+r exec autorandr i3; restart

#bindsym $mod+Shift+e exec "swaynag -e top -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? ' -b 'Yes, exit sway' 'swaymsg exit'"

# Rules
# Floating
#for_window [class="Plank"] gaps inner set 0 gaps outer set 0

for_window [class="Alacritty"] border pixel 3
for_window [class="floaterm" instance="floaterm"] floating enable border pixel 3
for_window [class="floaterm"] floating enable border pixel 3
for_window [instance="floaterm"] floating enable border pixel 3
for_window [title="floaterm"] floating enable border pixel 3
for_window [instance="termite"] border pixel 3
for_window [class="Clock-applet"] floating enable
for_window [class="Adobe Photoshop CS6"] floating enable
for_window [instance="keybase"] floating enable
for_window [window_role="pop-up"] floating enable
for_window [window_role="task_dialog"] floating enable
for_window [instance="vmware"] floating enable 

# Assign workspaces
for_window [class="Firefox"] move container to workspace $WS2
for_window [class="emacs"] move container to workspace $WS3
for_window [class="Thunderbird"] move container to workspace $WS4
for_window [class="Evolution"] move container to workspace $WS4
for_window [class="Remmina"] move container to workspace $WS5
for_window [class="Steam"] move container to workspace $WS7
for_window [class="Spotify"] move container to workspace $WS8
for_window [class="keepassxc"] move container to workspace $WS9

# Modes
bindsym $mod+Shift+g mode "$mode_gaps"
bindsym $mod+r mode "resize"

# resize window (you can also use the mouse for that)
mode "resize" {
        # These bindings trigger as soon as you enter the resize mode

        bindsym $left resize shrink width 10 px or 10 ppt
        bindsym $down resize grow height 10 px or 10 ppt
        bindsym $up resize shrink height 10 px or 10 ppt
        bindsym $right resize grow width 10 px or 10 ppt

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
}

set $mode_gaps Gaps: (o) outer, (i) inner
set $mode_gaps_outer Outer Gaps: +|-|0 (local), Shift + +|-|0 (global)
set $mode_gaps_inner Inner Gaps: +|-|0 (local), Shift + +|-|0 (global)
mode "$mode_gaps" {
        bindsym o      mode "$mode_gaps_outer"
        bindsym i      mode "$mode_gaps_inner"
        bindsym Return mode "default"
        bindsym Escape mode "default"
}

mode "$mode_gaps_inner" {
        bindsym plus  gaps inner current plus 5
        bindsym minus gaps inner current minus 5
        bindsym 0     gaps inner current set 0

        bindsym Shift+plus  gaps inner all plus 5
        bindsym Shift+minus gaps inner all minus 5
        bindsym Shift+0     gaps inner all set 0

        bindsym Return mode "default"
        bindsym Escape mode "default"
}
mode "$mode_gaps_outer" {
        bindsym plus  gaps outer current plus 5
        bindsym minus gaps outer current minus 5
        bindsym 0     gaps outer current set 0

        bindsym Shift+plus  gaps outer all plus 5
        bindsym Shift+minus gaps outer all minus 5
        bindsym Shift+0     gaps outer all set 0

        bindsym Return mode "default"
        bindsym Escape mode "default"
}

bar {
   status_command i3status
   position top
   font pango:SF Mono 10

       colors {
       background #000000
       separator #757575
       #                  border             background         text
       #focused_workspace  $bg-color          $bg-color          $text-color
       #inactive_workspace $inactive-bg-color $inactive-bg-color $inactive-text-color
       #urgent_workspace   $urgent-bg-color   $urgent-bg-color   $text-color
   }
}


exec --no-startup-id i3-msg "workspace $WS1"
exec --no-startup-id nvidia-settings --load-config-only
exec --no-startup-id autorandr i3
#restart
workspace $WS1 output DP-2
workspace $WS2 output DP-0
workspace $WS3 output DP-4
workspace $WS4 output DP1
workspace $WS5 output HDMI1

